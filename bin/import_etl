#!  /bin/bash 

############################################################################################
##### DTG 데이터 (교통안전공단)
############################################################################################

#####################
##### DELAYED, (full)
#####################
##### TINY
hadoop fs -rm -r -skipTrash data/로그/dtg_t
time ( upload_files $MARMOT_DATA/도로교통안전공단/dtg_t data/로그/dtg_t -b '64mb';	\
mc_bind_dataset data/로그/dtg_t -dataset 교통/dtg_t -type text -geom_col 'the_geom(EPSG:4326)')
##### SMALL
hadoop fs -rm -r -skipTrash data/로그/dtg_s
time ( upload_files $MARMOT_DATA/도로교통안전공단/dtg_s data/로그/dtg_s -b '64mb';	\
mc_bind_dataset data/로그/dtg_s -dataset 교통/dtg_s -type text -geom_col 'the_geom(EPSG:4326)')
##### MEDIUM
hadoop fs -rm -r -skipTrash data/로그/dtg_m
time ( upload_files $MARMOT_DATA/도로교통안전공단/dtg_m data/로그/dtg_m -b '64mb';	\
mc_bind_dataset data/로그/dtg_m -dataset 교통/dtg_m -type text -geom_col 'the_geom(EPSG:4326)')
##### LARGE
hadoop fs -rm -r -skipTrash data/로그/dtg_l
time ( upload_files $MARMOT_DATA/도로교통안전공단/dtg_l data/로그/dtg_l -b '64mb'; \
mc_bind_dataset data/로그/dtg_l -dataset 교통/dtg_l -type text -geom_col 'the_geom(EPSG:4326)')
##### HUGE
hadoop fs -rm -r -skipTrash data/로그/dtg_h
time ( upload_files $MARMOT_DATA/도로교통안전공단/dtg_h data/로그/dtg_h -b '64mb'; \
mc_bind_dataset data/로그/dtg_h -dataset 교통/dtg_h -type text -geom_col 'the_geom(EPSG:4326)')


#####################
##### DELAYED, 0  (count)
#####################
##### TINY
upload_files $MARMOT_DATA/도로교통안전공단/dtg_t data/로그/dtg_t0 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.0 data/로그/dtg_t0/_meta.st
mc_bind_dataset data/로그/dtg_t0 -dataset 교통/dtg_t0 -type text
##### SMALL
upload_files $MARMOT_DATA/도로교통안전공단/dtg_s data/로그/dtg_s0 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.0 data/로그/dtg_s0/_meta.st
mc_bind_dataset data/로그/dtg_s0 -dataset 교통/dtg_s0 -type text
##### MEDIUM
upload_files $MARMOT_DATA/도로교통안전공단/dtg_m data/로그/dtg_m0 -glob '**/*.csv' -f -b'64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.0 data/로그/dtg_m0/_meta.st
mc_bind_dataset data/로그/dtg_m0 -dataset 교통/dtg_m0 -type text
##### LARGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_l data/로그/dtg_l0 -glob '**/*.csv' -f -b'64mb' -f
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.0 data/로그/dtg_l0/_meta.st
mc_bind_dataset data/로그/dtg_l0 -dataset 교통/dtg_l0 -type text
##### HUAGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_h data/로그/dtg_h0 -glob '**/*.csv' -f -b'64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.0 data/로그/dtg_h0/_meta.st
mc_bind_dataset data/로그/dtg_h0 -dataset 교통/dtg_h0 -type text

#####################
##### DELAYED, 1 (group_by)
#####################
##### TINY
upload_files $MARMOT_DATA/도로교통안전공단/dtg_t data/로그/dtg_t1 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.1 data/로그/dtg_t1/_meta.st
mc_bind_dataset data/로그/dtg_t1 -dataset 교통/dtg_t1 -type text
##### SMALL
upload_files $MARMOT_DATA/도로교통안전공단/dtg_s data/로그/dtg_s1 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.1 data/로그/dtg_s1/_meta.st
mc_bind_dataset data/로그/dtg_s1 -dataset 교통/dtg_s1 -type text
##### MEDIUM
upload_files $MARMOT_DATA/도로교통안전공단/dtg_m data/로그/dtg_m1 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.1 data/로그/dtg_m1/_meta.st
mc_bind_dataset data/로그/dtg_m1 -dataset 교통/dtg_m1 -type text
##### LARGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_l data/로그/dtg_l1 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.1 data/로그/dtg_l1/_meta.st
mc_bind_dataset data/로그/dtg_l1 -dataset 교통/dtg_l1 -type text
##### HUGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_h data/로그/dtg_h1 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.1 data/로그/dtg_h1/_meta.st
mc_bind_dataset data/로그/dtg_h1 -dataset 교통/dtg_h1 -type text

#####################
##### DELAYED, 2 (spatial_join)
#####################
##### TINY
upload_files $MARMOT_DATA/도로교통안전공단/dtg_t data/로그/dtg_t2 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.2 data/로그/dtg_t2/_meta.st
mc_bind_dataset data/로그/dtg_t2 -dataset 교통/dtg_t2 -type text
##### SMALL
upload_files $MARMOT_DATA/도로교통안전공단/dtg_s data/로그/dtg_s2 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.2 data/로그/dtg_s2/_meta.st
mc_bind_dataset data/로그/dtg_s2 -dataset 교통/dtg_s2 -type text
##### MEDIUM
upload_files $MARMOT_DATA/도로교통안전공단/dtg_m data/로그/dtg_m2 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.2 data/로그/dtg_m2/_meta.st
mc_bind_dataset data/로그/dtg_m2 -dataset 교통/dtg_m2 -type text
##### LARGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_l data/로그/dtg_l2 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.2 data/로그/dtg_l2/_meta.st
mc_bind_dataset data/로그/dtg_l2 -dataset 교통/dtg_l2 -type text
##### HUGE
upload_files $MARMOT_DATA/도로교통안전공단/dtg_h data/로그/dtg_h2 -glob '**/*.csv' -f -b '64mb'
hadoop fs -copyFromLocal $MARMOT_DATA/도로교통안전공단/base/_meta.st.2 data/로그/dtg_h2/_meta.st
mc_bind_dataset data/로그/dtg_h2 -dataset 교통/dtg_h2 -type text


#####################
##### EAGER
#####################
##### TINY
time import_csv $MARMOT_DATA/도로교통안전공단/dtg_te -delim ',' -point_col 'X좌표,Y좌표' -header	\
'운행일자,운송사코드,차량번호,운행시분초,일일주행거리:int,누적주행거리:int,운행속도:short,RPM:short,브레이크신호:byte,X좌표,Y좌표,방위각:short,가속도X:float,가속도Y:float'	\
-dataset 교통/dtg_te -geom_col 'the_geom(EPSG:4326)' -f -b '64mb'
##### SMALL
time import_csv $MARMOT_DATA/도로교통안전공단/dtg_se -delim ',' -point_col 'X좌표,Y좌표' -header	\
'운행일자,운송사코드,차량번호,운행시분초,일일주행거리:int,누적주행거리:int,운행속도:short,RPM:short,브레이크신호:byte,X좌표,Y좌표,방위각:short,가속도X:float,가속도Y:float'	\
-dataset 교통/dtg_se -geom_col 'the_geom(EPSG:4326)' -f -b '64mb'
##### MEDIUM
time import_csv $MARMOT_DATA/도로교통안전공단/dtg_me -delim ',' -point_col 'X좌표,Y좌표' -header	\
'운행일자,운송사코드,차량번호,운행시분초,일일주행거리:int,누적주행거리:int,운행속도:short,RPM:short,브레이크신호:byte,X좌표,Y좌표,방위각:short,가속도X:float,가속도Y:float'	\
-dataset 교통/dtg_me -geom_col 'the_geom(EPSG:4326)' -f -b '64mb'
##### LARGE
time import_csv $MARMOT_DATA/도로교통안전공단/dtg_le -delim ',' -point_col 'X좌표,Y좌표' -header	\
'운행일자,운송사코드,차량번호,운행시분초,일일주행거리:int,누적주행거리:int,운행속도:short,RPM:short,브레이크신호:byte,X좌표,Y좌표,방위각:short,가속도X:float,가속도Y:float'	\
-dataset 교통/dtg_le -geom_col 'the_geom(EPSG:4326)' -f -b '64mb'
##### HUGE
time import_csv $MARMOT_DATA/도로교통안전공단/dtg_he -delim ',' -point_col 'X좌표,Y좌표' -header	\
'운행일자,운송사코드,차량번호,운행시분초,일일주행거리:int,누적주행거리:int,운행속도:short,RPM:short,브레이크신호:byte,X좌표,Y좌표,방위각:short,가속도X:float,가속도Y:float'	\
-dataset 교통/dtg_he -geom_col 'the_geom(EPSG:4326)' -f -b '64mb'
